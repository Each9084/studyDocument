## 集合

### 1.容器里哪些可以使null,哪些不能

### 2.为什么`ArrayList`可以为null

`ArrayDeque`底层是一个循环数组不能为null,但是为什么同样是数组的`arryList`却可以?









## 集合答案:

### 1.容器里哪些可以使null,哪些不能

第一派：兼容老派（允许 null）

这些容器设计较早，或者为了极致的灵活性，允许你塞入 `null`。

- `ArrayList`：随便塞，你想放多少个 `null` 都行。
- `LinkedList`：也是全能王，允许 `null`。
- `HashMap`：允许一个 `null` 作为 Key，多个 `null` 作为 Value。
- `HashSet`：允许存一个 `null`。

第二派：逻辑严谨派（严禁 null）

现代的高性能容器或有特殊排序逻辑的容器，通常拒绝 `null`。

- `ArrayDeque`：拒绝 `null`（原因如上）。
- `PriorityQueue`：拒绝 `null`。因为它要给元素排序，`null` 没法和别人比大小。
- `TreeSet` / `TreeMap`：拒绝 `null`。同样是因为需要比较大小，`null` 会引发 `NullPointerException`。



### 2.为什么`ArrayList`可以为null

**ArrayList 的秘密武器：`size`**

在 `ArrayList` 的源码里，除了那个 `elementData[]` 数组，还有一个至关重要的变量：`private int size;`。

- **它的作用**：记录当前列表里到底有多少个真正的元素。
- **如何区分**：
  - 如果 `size` 是 3，那么 `ArrayList` 就认为数组的 `[0, 1, 2]` 位是有意义的数据。
  - **即便 `elementData[1]` 存的是 `null`**，只要它的索引 $1 < size$，计算机就知道：“哦，这是用户存进去的一个真正的 `null` 值。”
  - 至于索引 3 以后的那些 `null`，因为它们 $\ge size$，`ArrayList` 会把它们看作“还没用到的空地”。